
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù„ÙˆØ­Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</title>

<!-- Ø®Ø· Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ -->
<link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&display=swap" rel="stylesheet">
<!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --bg1: #e0f2fe;
  --bg2: #fef9f9;
  --glass: rgba(255,255,255,0.6);
  --accent: #2563eb;
  --success: #16a34a;
  --warn: #facc15;
  --danger: #dc2626;
  --text-dark: #111827;
  --shadow: 0 8px 25px rgba(0,0,0,0.08);
  --font:'Almarai', sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:var(--font);background:linear-gradient(135deg,var(--bg1),var(--bg2));min-height:100vh;color:var(--text-dark);padding:1rem;}
.container{max-width:1400px;margin:auto;}
header{text-align:center;margin-bottom:2rem;animation:fadeIn 1s ease;}
header h1{font-size:2.4rem;font-weight:800;color:var(--accent);margin-bottom:1rem;}
@keyframes fadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.badges{display:flex;gap:0.6rem;flex-wrap:wrap;justify-content:center;margin-bottom:2rem;}
.badge{background:var(--glass);padding:0.6rem 1.2rem;border-radius:999px;font-weight:700;font-size:0.95rem;box-shadow:var(--shadow);backdrop-filter:blur(12px);transition:.3s;}
.badge:hover{transform:scale(1.05);}
.summary{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.2rem;margin-bottom:2.5rem;}
.summary-card{background:var(--glass);border-radius:20px;padding:1.5rem;text-align:center;backdrop-filter:blur(12px);box-shadow:var(--shadow);transition:.3s;position:relative;overflow:hidden;}
.summary-card:hover{transform:translateY(-6px) scale(1.02);}
.summary-card h3{font-size:1rem;opacity:.8;}
.summary-card .val{font-size:1.9rem;font-weight:800;margin-top:0.5rem;color:var(--accent);}
.malls{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1.5rem;}
.mall-card{background:var(--glass);border-radius:20px;padding:1.6rem;backdrop-filter:blur(10px);box-shadow:var(--shadow);cursor:pointer;transition:.3s;}
.mall-card:hover{transform:translateY(-6px);background:rgba(255,255,255,0.85);}
.mall-info h3{font-size:1.3rem;font-weight:800;margin-bottom:0.5rem;}
.progress{height:12px;border-radius:6px;background:#e5e7eb;overflow:hidden;margin-top:0.5rem;position:relative;}
.progress span{display:block;height:100%;border-radius:6px;box-shadow:inset 0 0 5px rgba(0,0,0,0.2);transition:width 1s ease;}
.progress .label{position:absolute;right:5px;top:-22px;font-size:0.8rem;font-weight:700;}
.best-depts{display:flex;gap:6px;margin-top:1rem;justify-content:center;}
.dept-card{background:var(--glass);width:100px;height:60px;border-radius:12px;font-size:.85rem;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#111827;box-shadow:var(--shadow);transition:.3s;text-align:center;}
.dept-card i{font-size:1.2rem;margin-bottom:4px;}
.dept-card:hover{transform:scale(1.05);}
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:999;}
.modal.show{display:flex;}
.modal-panel{max-width:1100px;width:95%;background:#fff;border-radius:20px;padding:1.5rem;box-shadow:0 10px 40px rgba(0,0,0,.3);animation:scaleIn .3s ease;}
@keyframes scaleIn{from{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}
.modal-head{display:flex;justify-content:space-between;align-items:center;}
.modal-head h2{font-size:1.5rem;font-weight:800;color:var(--accent);}
.modal-head button{border:none;background:var(--danger);color:#fff;padding:.5rem 1rem;border-radius:8px;cursor:pointer;font-weight:700;}
.modal-body{display:grid;grid-template-columns:380px 1fr;gap:1rem;margin-top:1rem;}
@media(max-width:1000px){.modal-body{grid-template-columns:1fr}}
.dept-table{width:100%;border-collapse:collapse;margin-top:1rem;font-size:.9rem;text-align:center;box-shadow:var(--shadow);}
.dept-table th,.dept-table td{border:1px solid #e5e7eb;padding:.5rem;}
.dept-table th{background:var(--accent);color:#fff;font-weight:700;}
.dept-table tr:nth-child(even){background:#f9fafb}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>Ù…Ø¤Ø´Ø±Ø§Øª Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</h1>
    <div class="badges">
      <div id="targetBadge" class="badge">Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…: --%</div>
      <div id="monthTarget" class="badge">Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±: 100%</div>
      <div id="varianceBadge" class="badge">Ø§Ù„ÙØ§Ø±Ù‚: --%</div>
      <div id="currentDate" class="badge">--</div>
    </div>
  </header>

  <div class="summary">
    <div class="summary-card"><h3>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ù…</h3><div class="val" id="avgVal">--%</div></div>
    <div class="summary-card"><h3>Ø£Ø¹Ù„Ù‰ Ù…Ø±ÙƒØ²</h3><div class="val" id="topMall">--</div></div>
    <div class="summary-card"><h3>Ø£Ù‚Ù„ Ù…Ø±ÙƒØ²</h3><div class="val" id="lowMall">--</div></div>
  </div>

  <section class="malls" id="mallsGrid"></section>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
<div id="modal" class="modal">
  <div class="modal-panel">
    <div class="modal-head">
      <h2 id="modalTitle"></h2>
      <button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
    <div class="modal-body">
      <div id="departmentsContainer"></div>
      <div><canvas id="deptChart"></canvas></div>
    </div>
  </div>
</div>

<script>
const today=new Date();
const currentDay=today.getDate();
const totalDays=new Date(today.getFullYear(),today.getMonth()+1,0).getDate();
const plannedPercentage=(currentDay/totalDays)*100;

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø§ÙƒØ² + Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ù‘Ø«Ø©
const mallsData={
  ansar:{title:"Ø§Ù„Ø£Ù†ØµØ§Ø± Ù…ÙˆÙ„",percentage:39.38,departments:[
    {name:"Ø§Ù„Ù…ÙØ±ÙˆØ´Ø§Øª",actual:28.84,icon:"fa-couch"},
    {name:"Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©",actual:23.55,icon:"fa-home"},
    {name:"Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠ",actual:38.04,icon:"fa-tshirt"},
    {name:"Ø§Ù„Ù†Ø³Ø§Ø¦ÙŠ",actual:37.63,icon:"fa-female"},
    {name:"Ø§Ù„ÙˆÙ„Ø§Ø¯ÙŠ",actual:34.24,icon:"fa-child"},
    {name:"Ø§Ù„Ø±ÙŠØ§Ø¶Ø©",actual:38.55,icon:"fa-bicycle"},
    {name:"Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨",actual:28.5,icon:"fa-gamepad"},
    {name:"Ø§Ù„Ø¹Ø·ÙˆØ±",actual:31.7,icon:"fa-spray-can"},
    {name:"Ø§Ù„Ù…ÙƒØªØ¨Ø©",actual:33.2,icon:"fa-book"},
    {name:"Ø§Ù„ØªØ®ÙÙŠØ¶Ø§Øª",actual:26.1,icon:"fa-tags"},
    {name:"Ø³ÙŠÙÙˆØ±Ø§",actual:30.3,icon:"fa-star"}
  ]},
  abyat:{title:"Ø£Ø¨ÙŠØ§Øª Ø¹Ø³ÙŠØ±",percentage:14.75,departments:[
    {name:"Ø§Ù„Ù…ÙØ±ÙˆØ´Ø§Øª",actual:13.76,icon:"fa-couch"},
    {name:"Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©",actual:15.12,icon:"fa-home"},
    {name:"Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ©",actual:19.98,icon:"fa-tshirt"},
    {name:"Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨",actual:11.23,icon:"fa-gamepad"}
  ]},
  fourpark:{title:"ÙÙˆØ± Ø¨Ø§Ø±Ùƒ",percentage:15.73,departments:[
    {name:"Ø§Ù„Ù…ÙØ±ÙˆØ´Ø§Øª",actual:16.26,icon:"fa-couch"},
    {name:"Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©",actual:11.71,icon:"fa-home"}
  ]},
  arabplaza:{title:"Ø§Ù„Ø¹Ø±Ø¨ Ø¨Ù„Ø§Ø²Ø§",percentage:15.05,departments:[
    {name:"Ø§Ù„Ù…ÙØ±ÙˆØ´Ø§Øª",actual:18.88,icon:"fa-couch"},
    {name:"Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©",actual:11.86,icon:"fa-home"},
    {name:"Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨",actual:12.65,icon:"fa-gamepad"}
  ]}
};

function formatDateArabic(d){return new Intl.DateTimeFormat('ar-EG',{year:'numeric',month:'long',day:'numeric'}).format(d);}
function calculateTarget(){return (3.33*new Date().getDate()).toFixed(2);}
const target=calculateTarget();
document.getElementById('targetBadge').textContent=`Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…: ${target}%`;
document.getElementById('currentDate').textContent=formatDateArabic(today);

function getColor(p){if(p>=target) return "var(--success)";if(p>=target/2) return "var(--warn)";return "var(--danger)";}

const mallsGrid=document.getElementById('mallsGrid');

function renderMalls(){
  mallsGrid.innerHTML="";
  const arr=Object.values(mallsData);
  const avg=(arr.reduce((a,c)=>a+c.percentage,0)/arr.length).toFixed(2);
  document.getElementById('avgVal').textContent=avg+"%";
  const top=arr.reduce((a,c)=>c.percentage>a.percentage?c:a);
  const low=arr.reduce((a,c)=>c.percentage<a.percentage?c:a);
  document.getElementById('topMall').textContent=`${top.title} (${top.percentage}%)`;
  document.getElementById('lowMall').textContent=`${low.title} (${low.percentage}%)`;
  const variance=(avg-plannedPercentage).toFixed(2);
  const varianceBadge=document.getElementById('varianceBadge');
  varianceBadge.textContent=`Ø§Ù„ÙØ§Ø±Ù‚: ${variance}%`;
  varianceBadge.style.color=variance>=0?"green":"red";

  arr.sort((a,b)=>b.percentage-a.percentage).forEach(m=>{
    const card=document.createElement('div');
    card.className="mall-card";
    card.onclick=()=>openModal(m);
    const info=document.createElement('div');
    info.className="mall-info";

    // ğŸ‘‡ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø£Ù…Ø§Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙƒØ²
    const bestDept=m.departments.reduce((a,c)=>c.actual>a.actual?c:a);
    info.innerHTML=`<h3>${m.title} - <span style="color:${getColor(m.percentage)}">${m.percentage}%</span></h3>
    <div class="progress">
      <span style="width:${m.percentage}%;background:${getColor(m.percentage)}"></span>
      <div class="label">${m.percentage}%</div>
    </div>
    <small>Ø£ÙØ¶Ù„ Ù‚Ø³Ù…: ${bestDept.name}</small>`;

    const bestDeptsContainer=document.createElement('div');
    bestDeptsContainer.className="best-depts";
    m.departments.sort((a,b)=>b.actual-a.actual).slice(0,3).forEach(d=>{
      const deptCard=document.createElement('div');
      deptCard.className="dept-card";
      deptCard.innerHTML=`<i class="fa ${d.icon}"></i>${d.name}`;
      bestDeptsContainer.appendChild(deptCard);
    });

    card.appendChild(info);
    card.appendChild(bestDeptsContainer);
    mallsGrid.appendChild(card);
  });
}
renderMalls();

let chart=null;
function openModal(mall){
  document.getElementById('modalTitle').textContent=mall.title;
  const cont=document.getElementById('departmentsContainer');
  cont.innerHTML="";
  const table=document.createElement('table');
  table.className="dept-table";
  table.innerHTML="<thead><tr><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ù…Ø®Ø·Ø·</th><th>Ø§Ù„Ù…Ø­Ù‚Ù‚</th><th>Ø§Ù„ÙØ§Ø±Ù‚</th></tr></thead>";
  const tbody=document.createElement('tbody');
  mall.departments.forEach(d=>{
    const diff=(d.actual-plannedPercentage).toFixed(2);
    tbody.innerHTML+=`<tr>
      <td>${d.name}</td>
      <td>${plannedPercentage.toFixed(2)}%</td>
      <td>${d.actual}%</td>
      <td style="color:${diff>=0?'green':'red'}">${diff}%</td>
    </tr>`;
  });
  table.appendChild(tbody);
  cont.appendChild(table);

  const ctx=document.getElementById('deptChart');
  if(chart){chart.destroy();}
  chart=new Chart(ctx,{
    type:'bar',
    data:{
      labels:mall.departments.map(d=>d.name),
      datasets:[
        {label:'Ø§Ù„Ù…Ø®Ø·Ø·',data:mall.departments.map(()=>plannedPercentage.toFixed(2)),backgroundColor:'rgba(50,70,175,0.8)'},
        {label:'Ø§Ù„Ù…Ø­Ù‚Ù‚',data:mall.departments.map(d=>d.actual),backgroundColor:'rgba(251,146,60,0.9)'}
      ]
    },
    options:{
      responsive:true,
      animation:{duration:1500,easing:'easeOutBounce'},
      scales:{y:{beginAtZero:true,suggestedMax:Math.max(...mall.departments.map(d=>Math.max(plannedPercentage,d.actual)))+5}}
    }
  });
  document.getElementById('modal').classList.add('show');
}
function closeModal(){document.getElementById('modal').classList.remove('show');}
</script>
</body>
</html>






